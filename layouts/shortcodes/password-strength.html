<script src="https://cdnjs.cloudflare.com/ajax/libs/zxcvbn/4.4.2/zxcvbn.js"></script>

<div class="clean-tool-card">
    <div class="tool-title">Password Strength Meter</div>
    
    <div class="input-group">
        <input type="password" id="password-input" placeholder="è¼¸å…¥å¯†ç¢¼æ¸¬è©¦å¼·åº¦..." autocomplete="off">
        <button onclick="toggleVisibility()" class="eye-btn" title="é¡¯ç¤º/éš±è—å¯†ç¢¼">ğŸ‘ï¸</button>
    </div>

    <div class="progress-container">
        <div id="strength-bar" class="progress-bar"></div>
    </div>

    <div class="stats-row">
        <div class="score-text">å¼·åº¦åˆ†æ•¸: <span id="score-val">0</span>/100</div>
        <div id="crack-time" class="time-text">é ä¼°ç ´è§£æ™‚é–“: 0ç§’</div>
    </div>

    <div id="feedback-msg" class="feedback-text"></div>

    <details class="security-note">
        <summary>ğŸ”’ å¦‚ä½•é©—è­‰æ­¤å·¥å…·çš„å®‰å…¨æ€§ï¼Ÿ (How to verify)</summary>
        <div class="note-content">
            <p>æœ¬å·¥å…·æ¡ç”¨ <strong>ç´”å®¢æˆ¶ç«¯ (Client-side only)</strong> é‹ç®—ï¼Œæ‚¨çš„å¯†ç¢¼æ°¸é ä¸æœƒé›¢é–‹ç€è¦½å™¨ã€‚</p>
            <ul style="margin-top: 5px; list-style-type: disc; padding-left: 20px;">
                <li><strong>æ–·ç¶²æ¸¬è©¦ï¼š</strong>æ‚¨å¯ä»¥è¼‰å…¥é é¢å¾Œã€Œæ‹”æ‰ç¶²è·¯ç·šã€ï¼Œå·¥å…·ä¾ç„¶èƒ½æ­£å¸¸é‹ä½œã€‚</li>
                <li><strong>F12 ç›£æ§ï¼š</strong>ä½¿ç”¨é–‹ç™¼è€…å·¥å…· (Network) ç›£æ§ï¼Œè¼¸å…¥å¯†ç¢¼æ™‚ä¸æœƒç”¢ç”Ÿä»»ä½•ç¶²è·¯è«‹æ±‚ã€‚</li>
            </ul>
        </div>
    </details>

    <div class="tool-footer">
        ğŸ›¡ï¸ Core engine powered by <a href="https://github.com/dropbox/zxcvbn" target="_blank">zxcvbn</a> (Industry Standard)
    </div>
</div>

<style>
    /* å¡ç‰‡ä¸»é«” */
    .clean-tool-card {
        background-color: #1d1e20;
        border: 1px solid #333;
        border-radius: 8px;
        padding: 25px;
        margin: 20px 0;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    .tool-title { font-size: 1.2rem; font-weight: bold; margin-bottom: 20px; color: #e0e0e0; }

    /* è¼¸å…¥æ¡† */
    .input-group { position: relative; display: flex; align-items: center; }
    
    #password-input {
        width: 100%;
        background: #2e2e33;
        border: 1px solid #444;
        color: #fff;
        padding: 12px;
        padding-right: 40px;
        border-radius: 4px;
        font-size: 1.1rem;
        outline: none;
    }
    
    .eye-btn {
        position: absolute; right: 10px; background: none; border: none;
        cursor: pointer; font-size: 1.2rem; color: #aaa;
    }

    /* é€²åº¦æ¢ */
    .progress-container {
        height: 10px; background-color: #333; border-radius: 5px;
        margin-top: 20px; overflow: hidden;
    }
    .progress-bar {
        height: 100%; width: 0%; background-color: #ff4444;
        transition: width 0.3s ease, background-color 0.3s ease;
    }

    /* ç‹€æ…‹åˆ— */
    .stats-row {
        display: flex; justify-content: space-between; margin-top: 15px;
        color: #ddd; font-size: 0.9rem; flex-wrap: wrap; gap: 10px;
    }
    
    .feedback-text {
        margin-top: 15px; font-size: 0.9rem; color: #ffa500; min-height: 1.2em;
    }

    /* å®‰å…¨æ€§èªªæ˜ (æŠ˜ç–Š) */
    .security-note {
        margin-top: 25px;
        border: 1px dashed #444;
        border-radius: 4px;
        padding: 10px;
        font-size: 0.85rem;
        color: #aaa;
    }
    .security-note summary {
        cursor: pointer; color: #bbb; font-weight: bold; outline: none;
    }
    .security-note summary:hover { color: #fff; }
    .note-content { margin-top: 10px; line-height: 1.5; color: #888; }
    .note-content strong { color: #ccc; }

    /* é å°¾ */
    .tool-footer {
        margin-top: 15px; padding-top: 15px; border-top: 1px solid #333;
        font-size: 0.8rem; color: #666; text-align: right;
    }
    .tool-footer a { color: #3b82f6; text-decoration: none; }
    .tool-footer a:hover { text-decoration: underline; }
</style>

<script>
    const input = document.getElementById('password-input');
    const bar = document.getElementById('strength-bar');
    const scoreVal = document.getElementById('score-val');
    const crackTime = document.getElementById('crack-time');
    const feedbackMsg = document.getElementById('feedback-msg');

    input.addEventListener('input', function() {
        const val = input.value;
        if (val === "") { resetMeter(); return; }

        const result = zxcvbn(val);
        
        // 0-100 åˆ†æ•¸è½‰æ›é‚è¼¯
        let rawScore = 0;
        if(result.guesses > 0) {
            // Log10(guesses) / 12 * 100
            rawScore = Math.min(100, Math.round((result.guesses_log10 / 12) * 100));
        }
        // å¦‚æœé•·åº¦å¤ªçŸ­ï¼Œå¼·åˆ¶å£“ä½åˆ†æ•¸
        if (val.length < 4) rawScore = Math.min(10, rawScore);

        updateUI(rawScore, result);
    });

    function updateUI(score, result) {
        scoreVal.innerText = score;
        bar.style.width = score + "%";
        
        // è®Šè‰²é‚è¼¯
        if (score < 20) { bar.style.backgroundColor = "#ff4444"; }      // ç´…
        else if (score < 50) { bar.style.backgroundColor = "#ffbb33"; } // æ©˜
        else if (score < 80) { bar.style.backgroundColor = "#00C851"; } // ç¶ 
        else { bar.style.backgroundColor = "#33b5e5"; }                 // è— (æœ€å¼·)

        crackTime.innerText = "é ä¼°ç ´è§£æ™‚é–“: " + result.crack_times_display.offline_slow_hashing_1e4_per_second;

        if (result.feedback.warning) {
            feedbackMsg.innerText = "âš ï¸ " + result.feedback.warning;
        } else if (result.feedback.suggestions.length > 0) {
            feedbackMsg.innerText = "ğŸ’¡ " + result.feedback.suggestions[0];
        } else {
            feedbackMsg.innerText = "";
        }
    }

    function resetMeter() {
        bar.style.width = "0%";
        scoreVal.innerText = "0";
        crackTime.innerText = "é ä¼°ç ´è§£æ™‚é–“: 0ç§’";
        feedbackMsg.innerText = "";
        bar.style.backgroundColor = "#ff4444";
    }

    function toggleVisibility() {
        const btn = document.querySelector('.eye-btn');
        if (input.type === "password") {
            input.type = "text";
            btn.innerText = "ğŸ”’";
        } else {
            input.type = "password";
            btn.innerText = "ğŸ‘ï¸";
        }
    }
</script>